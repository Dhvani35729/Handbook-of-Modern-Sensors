- "Chapter 2: "**Transfer Functions**""
  - "Since most of stimuli are not electrical, from its input to the output a sensor may perform several signal conversion steps before it produces and outputs an electrical signal."
  - "Yet, in this chapter we discuss the overall sensor characteristics, regardless of a physical nature."
  - "Here, we will consider a sensor as a "black box" where we are concerned only with the relationship between its output electrical signal and input stimulus, regardless of what is going on inside."
  - "Key goal of sensing: determination of the unknown input stimulus from the sensor's electric output"
    - "i.e. how does the input **relate** to the output and vice versa"
  - "Mathematical Models"
    - "An ideal or theoretical input-output (stimulus-response) relationship exists for every sensor."
    - "This ideal-output relationship may be expressed in the form of a table of values, graph, mathematical formula, or as a solution of a mathematical equation."
    - "If the input-output function is time invariant (does not change with time) it is commonly called a static transfer function or simply transfer function. "
    - "$$E = f(s)$$"
      - "A static transfer function (f) represents a relation between the input stimulus **s** and the electrical signal **E** produced by the sensor at its output"
      - "Normally, stimulus **s** is unknown while the output signal **E** is measured and thus becomes known"
      - "The value of **E** that becomes known during measurement is a number (voltage, current, digital count, etc.) that represents stimulus **s**."
      - "A job of the designer is to make that representation as close as possible to the true value of stimulus **s**."
    - "In reality, any sensor is attached to a measuring system (i.e. you want to calculate **s** and not **E**)"
    - "One of the functions of the system is to "break the code E" and infer the unknown value of **s** from the measured value of E."
    - "Thus, the measurement system shall employ an inverse transfer function $$s=f^{-1}(E) = F(E)$$, to obtain (compute) value of the stimulus **s**."
    - "It is usually desirable to determine a transfer function not just of a sensor alone, but rather of a system comprising the sensor and its interface circuit."
    - "Concept"
      - "Preferably (one case) is that a physical or chemical law that forms a basis for the sensor's operation should be known."
      - "If such a law can be expressed in form of a mathematical formula, often it can be used for calculating the sensor's inverse transfer function by inverting the formula and computing the unknown value of **s** from the measured output **E**."
      - "One example is inverting Ohm's law to compute displacement from the measured voltage."
      - "In practice, readily solvable formulas for many transfer functions, especially for complex sensors, does not exist and one has to resort to various approximations of the direct and inverse transfer functions. "
    - "Functional Approximations"
      - "What:"
        - "Approximation is a selection of a suitable mathematical expression that can fit the experimental data as close as possible."
          - "The act of approximation can be seen as a curve fitting of the experimentally observed values into the approximating function."
        - "The approximating function should be simple enough for ease of computation and inversion and other mathematical treatments"
          - "for example, for computing a derivative to find the sensor's sensitivity"
      - "Selecting a function"
        - "The selection of such a function requires some mathematical experience."
        - "There is no clean-cut method for selecting the most appropriate function to fit experimental data – eyeballing and pas experience perhaps is the only practical way to find the best fit."
      - "Initially, one should check if one of the basic functions can fit the data and if not, then resort to a more general curve-fitting technique."
      - "Some poplar functions used for approximations of transfer functions"
        - "Linear"
          - "simples model of a transfer function"
          - "Equation:"
            - "$$E = Bs + A$$"
              - "intercept = A"
              - "E = A, when s = 0 (i.e. zero input signal)"
              - "slope = B (sensitivity)"
                - "sometimes called sensitivity since the larger the coefficient the greater the stimulus influence"
          - "Graph"
            - "![](https://github.com/Dhvani35729/Handbook-of-Modern-Sensors/blob/master/Chapter_2/reading/media/fig_2.2.png)"
          - "The equation ("$$E = Bs + A$$") assumes that the transfer function passes, at least theoretically, through zero value of the input stimulus **s**."
          - "In many practical cases it is just difficult or impossible to test a sensor at zero input."
            - "eg. can't test a temperature sensor at absolute zero"
          - "Thus, in many linear or quasilinear sensors it may be desirable to reference the sensor not to the zero input but rather to some more practical input reference value $$s_0$$."
          - "If the sensor response is $$E_0$$ for some known input stimulus $$s_0$$, we can rewrite "$$E = Bs + A$$" in a more practical form:"
            - "$$E = B(s - s_0) + E_0$$"
            - "Reference points coordinates = $$(s_0, E_0)$$"
          - "Inverse transfer function:"
            - "$$s = \frac{E - E_0}{B} + s_0$$"
            - "Note that three constants shall be known for computing the stimulus **s**:"
              - ""slope = B (sensitivity)""
              - ""Reference points coordinates = $$(s_0, E_0)$$""
          - "Very few sensors are truly linear. In some cases, nonlinearity can be ignored for practical purpose."
        - "Logarithmic"
          - "Equation"
            - "$$E = Bln(s) + A$$"
              - "A and B are fixed parameters"
          - "Inverse transfer function"
            - "$$s = e^{\frac{E-A}{B}}$$"
          - "Graph"
            - "![](https://github.com/Dhvani35729/Handbook-of-Modern-Sensors/blob/master/Chapter_2/reading/media/fig_2.3.png)"
        - "Exponential"
          - "Equation"
            - "$$E = Ae^{ks}$$"
              - "A and k are fixed parameters"
          - "Inverse transfer function"
            - "$$s = \frac{1}{k}ln(\frac{E}{A})$$"
          - "Graph"
            - "![](https://github.com/Dhvani35729/Handbook-of-Modern-Sensors/blob/master/Chapter_2/reading/media/fig_2.4.png)"
        - "Power"
          - "Equation"
            - "$$E = Bs^k + A$$"
              - "A and B are fixed parameters"
              - "k is the power factor"
          - "Inverse transfer function"
            - "$$s = \sqrt[k]{\frac{E-A}{B}}$$"
          - "Graph"
            - "![](https://github.com/Dhvani35729/Handbook-of-Modern-Sensors/blob/master/Chapter_2/reading/media/fig_2.5.png)"
      - "All of the nonlinear approximations possess a small number of parameters that shall be determined during "Calibration"."
      - "It is always useful to have as small a number of parameters as possible:"
        - "lowers cost of sensor calibration"
        - "the smaller the number of measurements to be made during calibration"
    - "Linear Regression"
      - "If measurements of the input stimuli during calibration cannot be made consistently with high accuracy and large random errors are expected, the minimal number of measurements will not yield a sufficient accuracy."
      - "To cope with random errors in the calibration process, a method of least squares could be employed to find the slope and intercept."
      - "method of least squares"
        - "1. Measure multiple (**k**) output values **E** at the input value **s** over a substantially broad range, preferably over the entire sensor span."
        - "2. Use the following formulas for a linear regression to determine intercept A and slope B of the best-fitting straight line of "$$E = Bs + A$$":"
          - "$$A = \frac{\sum E \sum s^2 - \sum s \sum sE}{k \sum s^2 - ( \sum s)^2}$$"
          - "$$B = \frac{k \sum sE - \sum s \sum E}{k \sum s^2 - (\sum s)^2}$$"
          - "$$\sum$$ is the summation over all **k** measurements"
        - "When the constants A and B are found, "$$E = Bs + A$$" can be used as a linear approximation of the experimental transfer function."
    - "Polynomial Approximations"
      - "Sometimes, none of the above basic functional approximations will fit sufficiently well. "
      - "A sensor designer may utilize some other suitable functional approximations, but if none is found, several techniques come in handy,"
      - "One is a polynomial approximation, that is, a power series."
      - "^^Any continuous function, regardless of its shape, can be approximated by a power series.^^"
      - "In many cases it is sufficient to see if the sensor's response can be approximated by the second or third degree polynomials to fit well into the experimental data."
      - "These approximation functions can be expressed as:"
        - "second degree polynomial"
          - "$$E = a_2s^2 + a_1s + a_0$$"
        - "third degree polynomial"
          - "$$E = b_3s^3 + b_2s^2 + b_1s + b_0$$"
      - "The same technique can be applied to the inverse transfer functions"
        - "second degree polynomial"
          - "$$s = A_2E^2 + A_1E + A_0$$"
        - "third degree polynomial"
          - "$$s = B_3E^3 + B_2E^2 + B_1E + B_0$$"
      - "The coefficients A and B can be converted into coefficients a and b, but the analytical conversion is rather cumbersome and rarely used."
      - "Instead, depending in the need, usually either a direct or inversed transfer function is approximated from the experimental data points, but not both."
      - "In some cases, especially when more accuracy is required, the higher order polynomials should be considered because the higher the order of a polynomial the better the fit."
    - "Sensitivity"
      - "Recall for a linear function: "slope = B (sensitivity)""
      - "For a nonlinear transfer function, sensitivity is not a fixed number."
      - "A nonlinear transfer function exhibits different sensitivities at different points in intervals of stimuli."
        - "Sensitivity is defined as a first derivative of the transfer function at the particular stimulus $$s_i$$:"
          - "$$b_i(s_i) = \frac{dE(s_i)}{ds} = \frac{\Delta E_i}{\Delta s_i}$$"
            - "$$\Delta s_i$$ is a small increment of the input stimulus"
            - "$$\Delta E_i$$ is the corresponding change in the sensor output **E**"
    - "Linear Piecewise Approximation"
      - "Powerful method to use in a computerized data acquisition system"
      - "The idea behind it is to break up a nonlinear transfer function of any shape into sections and consider each such section being linear."
      - "Curved segments between the sample points (knots) demarcating the sections are replaced with straight-line segments, thus greatly simplifying behaviour of the function between the knots."
      - "![](https://github.com/Dhvani35729/Handbook-of-Modern-Sensors/blob/master/Chapter_2/reading/media/fig_2.6.png)"
      - "It makes sense to select knots only for the input range of interest"
      - "An error of a piecewise approximation can be characterized by a maximum deviation $$\delta$$ of the approximation line from the real curve."
      - "Different definitions exist for this maximum deviation (mean square, absolute max, average, etc.)"
        - "but whatever is the adopted metric, the larger $$\delta$$ calls for a greater number of samples"
          - "that is a larger number of sections with the idea of making this maximum deviation acceptably small"
        - "i.e. the larger the number of the knots, the smaller the error"
        - "The knots do not need to be equally spaced"
          - "They should be closer to each other where nonlinearity is high and farther apart where nonlinearity is small"
    - "Spline Interpolation"
      - "(like linear piecewise approximation but higher orders)"
      - "One problem with approximations by higher order polynomials (third order and higher) is that the selected points at one side of the curve make strong influence on the remote (far) parts of the curve"
      - "This deficiency is resolved by the spline method of approximation."
      - "The spline method uses different third-order polynomial interpolations between the selected experimental points called knots."
      - "It is a curve between two neighbouring knots and then all curves are "stitched" or "glued" together to obtain a smooth combined curve fitting"
      - "Doesn't have to be a third-order curve (most popular)"
      - "A first-order interpolation (linear spline interpolation) is equivalent to a linear piecewise approximation"
      - "Curvature of a line at each point is defined by the second derivative."
      - "The derivative should be computed at each knot."
      - "If the second derivatives are zero, the cubic spline is called "relaxed"."
      - "Spline interpolation is the efficient technique when it comes to an interpolation that preserves smoothness of a transfer function."
    - "Multidimensional Transfer Function"
      - "A sensor transfer function may depend on more than one input variable."
        - "i.e. the sensor's output may be a function of several stimuli"
  - "Calibration"
    - "A calibration is required whenever a higher accuracy is required from a less accurate sensor"
    - "For example, if one needs to measure temperature with accuracy, say 0.1 ºC, while the available sensor is rated as having accuracy of 1 ºC, it does not mean that the sensor cannot be used."
    - "Rather this particular sensor needs calibration."
    - "Process of calibration = a unique transfer function is determined"
    - "A calibration requires application of several precisely known stimuli and reading the corresponding sensor responses."
      - "These are called the calibration points whose input-output values are the point coordinates."
      - "typically 2-5 calibration points are needed for high accuracy"
    - "After the unique transfer function is established, any point in between the calibration points can be determined"
    - "To produce the calibration points, a standard reference source of the input stimuli is required."
    - "The calibration accuracy is directly linked to accuracy of a reference sensor that is part of the calibration equipment."
      - "A value of uncertainty of the reference sensor should be included in the statement of the overall uncertainty."
    - "Before calibration, either a mathematical model of the transfer function or a good approximation of the sensor's response over the entire span shall be found."
    - "Calibration of a sensor can be done in several possible ways, some of which are the following:"
      - "1. Modifying the transfer function or its approximation to fit the experimental data."
        - "This involves computation of the coefficients (parameters) for the selected transfer function."
        - "The sensor is not modified"
      - "2. Adjustment of the data acquisition system to trim (modify) its output by making the output signal to fit into a normalized or "ideal" transfer function"
        - "An example is scaling and shifting the acquired data (modifying the system gain and offset)"
        - "The sensor is not modified"
      - "3. Modification (trimming) the sensor's properties to fit the predetermined transfer function"
        - "The sensor itself is modified"
      - "4. Creating the sensor-specific reference device with the matching properties at particular calibration points"
        - "This unique reference is used by the data acquisition system to compensate for the sensor's inaccuracy"
        - "The sensor is not modified"
      - "Example of calibrating a thermistor "
        - "![](https://github.com/Dhvani35729/Handbook-of-Modern-Sensors/blob/master/Chapter_2/reading/media/fig_2.8.png)"
  - "Computation of Parameters"
    - "If a transfer function is linear, then calibration should determine constants A and B."
    - "If it is exponential, the constants A and k should be determined, and so on."
    - "Note that the parameters found from calibration are unique for the particular sensor and must be stored in the measurement system to which that particular sensor is connected."
    - "With linear transfer functions, simple algebra will allow us to calculate the constants, but with higher-order polynomials, you will end up with a system of equations. Then, you can use techniques from [[linear algebra]] to calculate the coefficients."
    - "If an acceptable accuracy can be achieved by a second-order polynomial, a third order should not be used"
      - "It is important to save time and thus minimize the number of calibration points. "
  - "Computation of a Stimulus"
    - "A general goal of sensing is to determine the value of the input stimulus **s** from the measured output signal **E**."
    - "This can be done by two methods"
      - "From an inverted transfer function $$s = F(E)$$, that may be either an analytical or approximation function"
      - "From a direct transfer function $$E = f(s)$$ by use of an iterative computation"
    - "Use of Analytical Equation"
      - "Straightforward approach:"
        - "Measure the output signal **E**, plug it into the formula, and compute the sought input stimulus **s**"
    - "Use of Linear Piecewise Approximation"
      - "Use interpolation"
    - "Iterative Computation of Stimulus (Newton Method)"
      - "If the inverse transfer function is not known, the iterative method allows using a direct transfer function to compute the input stimulus"
      - "A very powerful method of iterations is the Netwon or secant method."
        - "It is based on first guessing the initial reasonable value of stimulus $$s = s_0$$ and then applying the Newton algorithm to compute a series of new values of **s** converging to the sought stimulus value."
        - "Thus, the algorithm involves several steps of computation, where each new step brings us closer and closer to the sough stimulus value."
        - "When a difference between two consecutively computed values of **s** becomes sufficiently small (less than an acceptable error), the algorithm stops and the last computed value of **s** is considered a solution of the original equation, and thus the value of the unknown stimulus is found."
      - "Newton's method converges remarkably quick, especially if the initial guess is reasonably close to the actual value of **s**"
      - "It should be noted that the Newton method results in large errors when the sensor's sensitivity becomes low."
        - "In order words, the method will fail where the transfer function flattens (1st derivative approaches zero)"
        - "In such cases, the so-called Modified Newton Method may be employed."
